<div class="dashboard-container">
  <h1>Dashboard</h1>

  @if (stats$ | async; as stats) {
    <div class="cards-container">
      <mat-card>
        <mat-card-header>
          <mat-card-title>Top Artistas</mat-card-title>
          <mat-card-subtitle>Com mais álbuns catalogados</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <mat-list role="list">
            @for (artist of stats.topArtists; track artist.artistName) {
              <mat-list-item role="listitem">
                <mat-icon matListItemIcon>person</mat-icon>
                <div matListItemTitle>{{ artist.artistName }}</div>
                <div matListItemLine>{{ artist.albumCount }} álbum(ns)</div>
              </mat-list-item>
            } @empty {
              <p>Nenhum artista catalogado.</p>
            }
          </mat-list>
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-card-header>
          <mat-card-title>Década Predominante</mat-card-title>
          <mat-card-subtitle>Com base na sua biblioteca</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content class="stat-content">
          @if (stats.predominantDecade) {
            <span class="big-number">{{ stats.predominantDecade }}s</span>
          } @else {
            <p>Nenhum álbum para calcular.</p>
          }
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-card-header>
          <mat-card-title>Álbuns Mais Bem Avaliados</mat-card-title>
          <mat-card-subtitle>Com base nas suas notas</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <mat-list role="list">
            @for (album of stats.topRatedAlbums; track album.id) {
              <mat-list-item role="listitem">
                <mat-icon matListItemIcon>album</mat-icon>
                <div matListItemTitle>{{ album.title }}</div>
                <div matListItemLine>Nota Média: {{ album.averageRating.toFixed(1) }}</div>
              </mat-list-item>
            } @empty {
              <p>Nenhum álbum avaliado ainda.</p>
            }
          </mat-list>
        </mat-card-content>
      </mat-card>
    </div>
  } @else {
    <div class="spinner-container">
      <mat-spinner></mat-spinner>
    </div>
  }
</div>